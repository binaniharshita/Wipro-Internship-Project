<HTML>
<HEAD>
<TITLE>Calendar</TITLE>
<STYLE TYPE="text/css">
  text-align:center
</STYLE>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>
<link rel="stylesheet" type="text/css" href="mystyle.css">

</HEAD>

<body onLoad="fillYears(); setMonthYear(document.dateChooser); " >
<TABLE ID="main_table">
<TD id="col_1">
<TABLE ID="calendarTable" ALIGN="center">

<TR>
    <TH ID="tableHeader" COLSPAN=7></TH>
</TR>

<TR id="days"><TH>Mon</TH><TH>Tue</TH><TH>Wed</TH><TH>Thu</TH><TH>Fri</TH><TH>Sat</TH><TH id="mark" >Sun</TH></TR>
<TBODY ID="tableBody"></TBODY>
<TR>  
    <TD COLSPAN=7>
    <FORM id="datechooser" NAME="dateChooser">
        <SELECT NAME="chooseMonth" 
        onChange="setMonthYear(this.form)">
            <OPTION SELECTED>January<OPTION>February<OPTION>March<OPTION>April<OPTION>May<OPTION>June<OPTION>July<OPTION>August<OPTION>September<OPTION>
            October<OPTION>November<OPTION>December
    </SELECT>
    <SELECT NAME="chooseYear" onChange="setMonthYear(this.form)">
    </SELECT>
    <P ondblclick="populateTable2(this.form)" id="event_handler"></P>
    </FORM>
    </P></TD>
</TR>
</TABLE>
</TD>


<TD id="col_2">
<form id = "form2" >
<TABLE ID="detailEvents">
<TR id="header1">
  <TH id="Heading" colspan=5 style="height:20px;"></TH>
</TR>
   
<TR>
<TH id="col1" style="padding-left:1.5%;background-color:#d4d5d6;">Time</TH>
<TH id="col2" style="padding-right:20%;">Events</TH>
<TH id="col3"></TH>
<TH id="col4"></TH>
<TH id="col5"></TH>
<TBODY ID="tableBody1" ></TBODY>
</TR>

</TABLE>
</form>

</TD>
</TABLE>


<div id="Adding_events_overlay" style="display: none">
<form id="form1" >
		<p class="editing_title" style="padding-bottom:7.5%" > Event Entry </p>
		
		<p1 class="show1">Event Type</p1><br>
		<select class="selection" id="event_type" name= " chooseType" onchange="" style="font-size:20px"><OPTION>Birthday<OPTION>Anniversary<OPTION>Meeting<OPTION>Others</select><br>
		<br>
		
		<p2 class="show1">Event Details</p2><br>
		<input class="selection" id="event_details" type="text" name="details" size="20%"><br>
		<br>
		
		<p2 class="show1" >Event Place</p2><br>
		<input class="selection" id="event_place" type="text" name="details" size="20%" ><br>
		<br>
		
		<p3 class="show1">Event Time</p3><br>
		<input class="selection" id="event_time" type="time" name="time" value=""><br><br>
		
		<p5 class="show1">Enter a colour for your reminder</p5><br>
		<input class="selection" type="color" id="event_color" name="color" value="#e66465"><br><br>
		
		<p6 class="show1">Enter the duration</p6><br>
		<SELECT id="event_duration" NAME="chooseDuration" class="selection" ><OPTION SELECTED><0.5 hr <OPTION>0.5 hr<OPTION>1 hr</SELECT>
		
		<p4 id="outputArea" style="display:none; color:#0000ff; font-size:15px; margin-left:10%" >Enter all the fields!</p4><br>
		
		<button id="button" type="button" style="float:right; cursor: pointer;color:#ffffff;" style="margin:15%;color:#ffffff;" >Set</button>
		<button id="button1" type="button" style="float:right; cursor: pointer;color:#ffffff;" style="margin:15%;color:#ffffff;" >Cancel</button>
		
		

</form>
</div>
	
	
<div id="Reminder_prompt_overlay" style="display: none">
	<p9 class="show1" id="prompt1">Do you want to set a reminder for this date?</p9><br>
	<button id="btn" onclick="Set_Reminder()" style="cursor: pointer;float:right;padding-right:2%;color:#ffffff;">Set</button>
	<button id="btn1" onclick="Cancel_Reminder()" style="cursor: pointer; float:right;padding-right:2%;color:#ffffff;">Cancel</button>
</div>


<div id="Delete_prompt_overlay" style="display: none">
    <p9 class="show1" id="prompt1">Do you want to delete this reminder?</p9><br>
	<button id="btn_yes" onclick="removeItem()" style="cursor: pointer;float:right;padding-right:2%;color:#ffffff;">Yes</button>
	<button id="btn_no" onclick="cancelDeletion()" style="cursor: pointer; float:right;padding-right:2%;color:#ffffff;">No</button>
</div>


<div id="display_overlay" style="display: none">
	<p class="editing_title" style="padding-bottom:7.5%;padding-top:5%;color:#3065c1">Event</p>
	<p class="show1">Event Type </p>
	<p class="show" id="disp_type" ></p>

	<p class="show1">Event Details </p>
	<p class="show" id="disp_detail"></p>

	<p class="show1" id="disp_place_tag">Event Place </p>
	<p class="show" id="disp_place"></p>

	<p class="show1">Event Time </p>
	<p class="show" id="disp_time"></p>

	<p class="show1">Event Duration</p>
	<p class="show" id="disp_duration"></p><br>

	<button type="button" id="close_btn" style="float:right;cursor: pointer;color:#ffffff;" onclick="close_form()" >Close</button>
</div>


<div id="edit_events_overlay" style="display: none">
<form id="form3" >
		<p01 class="editing_title" style="padding-bottom:7.5%;padding-top:5%;">Edit Event</p01><br>
		<p1 class="show1">Event Type</p1><br>
		<select class="selection" id="event_type1" name= " chooseType" style="font-size:20px;"><OPTION>Birthday<OPTION>Anniversary<OPTION>Meeting<OPTION>Others</select><br>
		
		
		<p2 class="show1">Event Details</p2><br>
		<input class="selection" id="event_details1" type="text" name="details" style="font-size:20px" value=""><br>
		
		<p2 class="show1" >Event Place</p2><br>
		<input class="selection" id="event_place1" type="text" name="details" style="font-size:20px;" value=""><br>
		
		
		<p3 class="show1">Event Time</p3><br>
		<input class="selection" id="event_time1" type="time" name="time" value="" style="font-size:20px"><br>
		
		<p3 class="show1">Event Color</p3>
		<input class="selection" id="event_color1" type="color" name="color" value="#e66465" style="font-size:20px"><br>
		
		<p3 class="show1">Event Duration</p3>
		<SELECT class="selection" id="event_duration1" value="" NAME="duration" ><OPTION SELECTED><0.5 hr <OPTION>0.5 hr<OPTION>1 hr</SELECT><br>
		
		<button id="button" type="button" style="float:right;cursor:pointer;color:#ffffff;" style="margin:25%;color:#ffffff; " onclick="saveChange()"  >Set</button>
		<button id="button1" type="button" style="float:right; cursor:pointer;color:#ffffff;" style="margin:25%;color:#ffffff;" onclick="cancelChange()" >Cancel</button>
	
</form>
</div>

<script type="text/javascript">
 
    var theMonth,theYear;
    var set2;
	var iSave=0;	
    var mon, yr,b=9;
	var list_e = new Array();
    var l = 0;
	var iCount=1;
	var d = new Date();
	var k= d.getDate();
    var key, newR1,key1;
	var day_week = d.getDay();
    var set1 = k + "/"+ (theMonth+1)+"/"+ theYear;
	
	
	// create array of month names
	var theMonths = ["January","February","March","April","May","June","July","August","September","October","November","December"];
	// create array of number of days in a month
	var monthLen = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
	//create the array of weekdays
	var week = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
	//create array of holidays
	var holiday = [{date:15,month:"August",Event:"Independence Day"},{date:26,month:"January",Event:"Republic Day"},{date:2,month:"October",Event:"Gandhi Jayanti"},{date:25,month:"December",Event:"Christmas"}];
	//create array for all dates having events in theMonth
	var events = [];
	//create array to get the day name
	var gsDayNames = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];


function getFirstDay(theYear, theMonth){
    var firstDate = new Date(theYear,theMonth,1)
    return firstDate.getDay();
}


// number of days in the month
function getMonthLen(theYear, theMonth) {
    var oneDay = 1000 * 60 * 60 * 24;
    
   
    if (theYear % 400 == 0)
    {
	monthLen[1] = 29;
    }
    else if((theYear % 4 == 0)&&( theYear % 100 == 0))
    {
	monthLen[1] = 29;
    }
    var len = monthLen[theMonth];
    return len;
}


//emptying fields on load
function emptyField(){
    document.getElementById("outputArea").style.display="none";
	document.getElementById("form1").reset();
}


function getObject(obj) {
    var theObj
    if (document.all) {
        if (typeof obj == "string") {
            return document.all(obj)
        } else {
            return obj.style
        }
    }
    if (document.getElementById) {
        if (typeof obj == "string") {
            return document.getElementById(obj)
        } else {
            return obj.style
        }
    }
    return null;
}



//setting reminder
function Set_Reminder()
{
  document.getElementById("Reminder_prompt_overlay").style.display = "none";
  document.getElementById("Adding_events_overlay").style.display = "block";
 // document.getElementById("Adding_events_overlay").reset();
}



//cancelling of reminder setting
function Cancel_Reminder()
{
  document.getElementById("Reminder_prompt_overlay").style.display = "none";
}



function setMonthYear(form)
{  
    theMonth = form.chooseMonth.selectedIndex;
    theYear = parseInt(dateChooser.chooseYear.options[dateChooser.chooseYear.selectedIndex].text);
    
	if(localStorage)
	{
	   for (var i = 0; i < localStorage.length; i++) {
            key = localStorage.key(i);
			
			
			
			if((theMonth+1)>=10)
			 b=10;
			else
			 b=9;
		
		
          var key_check = key.substring(0,b);
		  if(key_check.substring(key_check.length-1)=='w')
		   key_check=key_check.substring(0,key_check.length-1);
			   
				var n = events.includes(key_check);
				if(n==false)
				events.push(key_check);          
        }
	}
	populateTable1(theMonth,theYear);
    populateTable2(theMonth,theYear);
	
}


// clear and re-populate table based on form's selections
function populateTable1(theMonth,theYear) {
   
    var firstDay = getFirstDay(theYear, theMonth);
	firstDay = firstDay - 1;
    var howMany = getMonthLen(theYear, theMonth);
     var d = new Date();
	
    // fill in month/year in table header
	mon = '<p1 id="mon1">' +theMonths[theMonth]+ '</button>&nbsp;'
	yr = '<p2 id="yr1">' + theYear+ '</p2>';

	getObject("tableHeader").innerHTML = '<img onclick="changeMonBefore(theMonths[theMonth])" src="arrow_left.png" alt="arrow left" width="20px" height="20px" style="cursor: pointer;padding-top:5px;"  /> &nbsp&nbsp&nbsp'+mon + " " + yr + '&nbsp&nbsp&nbsp<img src="arrow_right.png" alt="arrow right" width="20px" height="20px" onclick="changeMonAfter(theMonths[theMonth])" style="cursor: pointer;" />';    

    // initialize vars for table creation
    var dayCounter = 1;
	
    var TBody = getObject("tableBody");
	
    // clear any existing rows
    while (TBody.rows.length > 0) {
        TBody.deleteRow(0)
    }
    var newR, newC;
    var done=false;
	
    while (!done) {
        // create new row at end
		
        newR = TBody.insertRow(TBody.rows.length);
        for (var i = 0; i < 7; i++) {
            // create new cell at end of row
			newC = document.getElementById("tableBody");
						
            newC = newR.insertCell(newR.cells.length);
            if (TBody.rows.length == 1 && i < firstDay) {
                // no content for boxes before first day
                newC.innerHTML = "" ;
                continue;
            }
			
            if (dayCounter == howMany) {
                // no more rows after this one
                done = true;
            }
            
		if( dayCounter <= howMany){
		    newC.innerHTML=dayCounter++;
			newC.className = "cellColor";
			if((dayCounter-1)==k)
			{
			  newC.style.backgroundColor="#C0C0C0";
			}
		   		  
		   if(i==6)
		   {
		   newC.style.color = "mediumvioletred";
		    newC.style.fontWeight="bold";
		   }
		   else
		   newC.style.color = "black";
		   
		   for(var x=0;x<holiday.length;x++)
		   { 
		      if(((dayCounter-1)==holiday[x].date)&&(theMonths[theMonth]==holiday[x].month))
			  {
			   newC.innerHTML='<div class="tooltip" >' +(dayCounter-1)+ '<span class="tooltiptext" >' +holiday[x].Event+ '</span></div>'
			   newC.style.color = "mediumvioletred";
			  }
			   

		   }
		   
		   set3 = (dayCounter-1) + "/"+ (theMonth+1)+"/"+ theYear;
		    for(var x=0;x<events.length;x++)
		     { 
		      if(set3==events[x])
			   newC.style.backgroundColor = "#e2baba";
		     }
		  
		      
		   
        
		    newC.addEventListener("click",dayClick);
		    newC.addEventListener("dblclick",double_dayClick);

		 }
		
        }
        
    }
	
 
}



//clicking on a date
function dayClick()
{
    k = this.innerText;
	 if(k.length!=1&&k.length!=2)
	 {
	 k=k.substring(0,2);
	 
	 if(k.substring(1)>0&&k.substring(1)<9)
	  k=k.substring(0,2);
	  else
	   k=k.substring(0,1);
	 }
	 
	 for(var i=0;i<monthLen[theMonth];i++)
	 {
	    document.getElementsByClassName("cellColor")[i].style.backgroundColor="#FFFAF0";
		var set4 = (i+1) + "/"+ (theMonth+1)+"/"+ theYear;
		
		for(var x=0;x<events.length;x++)
		 {
		  if(set4==events[x])
		  document.getElementsByClassName("cellColor")[i].style.backgroundColor="#e2baba";
		 }
	 }
	 
	
	this.style.backgroundColor="#C0C0C0";
	populateTable2(theMonth,theYear);
	
	  
}

//fill the details in the events table
function populateTable2(theMonth,theYear){
    
     
     var set3 = theYear+"-"+(theMonth+1)+"-"+k;
	 console.log(k);
     var d1 = new Date(set3);
     var dayName = gsDayNames[d1.getDay()];
	 
	 set1 = k + "/"+ (theMonth+1)+"/"+ theYear;
	 set2 = set1;
	 var set4 = dayName + " - "+ theMonths[theMonth]+" "+k+", "+theYear;
	 var set5 = document.getElementById("Heading");
	 
    getObject("Heading").innerHTML = '<p style="float:left;font-weight:bold; padding-left:1%;";font-size:12px;>' + set4 + '</p>';
    document.getElementById("Heading").style.backgroundColor="#d4d5d6";
  
    var hourCounter=24;
    var TBody = getObject("tableBody1");
	
    // clear any existing rows
    while (TBody.rows.length > 0) {
        TBody.deleteRow(0);
    }
    var newR, newC, newC1,l=0, newC2="", newc3="";
    var done=false;
	
	//extracting from local storage
	b=9;
	var list_e = new Array();
	var list_key = new Array();
	var counter=0;
	
   if (localStorage) {
        for (var i = 0; i < localStorage.length; i++) {
            key = localStorage.key(i);
			if((theMonth+1)>=10)
			{ 
			  b = 10;
			  if(k<10)
			   b=9;
			}
			else
			{ 
			   b=9;
			   if(k<10)
			   b=8;
			}
		
		 key1 = key.substring(b+1);
		
            if (key.substring(0,b) == set1) {
			   
                var item = localStorage.getItem(key);
                var todoItem = JSON.parse(item);
                list_e.push(todoItem);
				list_key.push(key1);
           }
        }
	}


   iCount = 1;
   var day_time=":00";
   var new_R1,new_R2,new_R3,new_R4;
   var f=1;
  newC2 = document.getElementById("tableBody1");
  newC2="";
  newC3 = document.getElementById("tableBody1");
  newC3="";
   for(var j=0; j<24; j++){
	
        // create new row at end
        newR = TBody.insertRow(TBody.rows.length);
		
        for (var i = 0; i < 5; i++) {
            newR1 = document.getElementById("tableBody1");
			newC1 = document.getElementById("tableBody1");
            newC = newR.insertCell(newR.cells.length);
			newC.innerHTML=" ";
        if(i==0){
			newC.innerHTML = '<p style="text-align:left; padding-left:10px;">'+j+day_time.sup()+'</p>';
		    newC.style.backgroundColor = "#d4d5d6";
		  }
		
		if(i==1)
        { 
		    newC1="";
			newR1="";
		  
			
		   for(var m=0; m<list_e.length; m++)
		   {
		      var g = list_e[m].event_time; 
		    
			  if(g.substring(0,2)==j)
			  {
			      var x6 = list_e[m].event_duration;
				  if(x6=="<0.5 hr")
				  x6="less than 0.5 hr";
			     if(list_e[m].event_place==undefined||list_e[m].event_place=="")
                  newR1 = '<font style="font-weight:bold;font-size:15px;">' + list_e[m].event_type + '</font>' + " " + '<font style="font-size:14px">' + list_e[m].event_details + " at " + list_e[m].event_time + " " + "for " + x6+'</font>';
				  else
                  newR1 = '<font style="font-weight:bold;font-size:15px;">' + list_e[m].event_type + '</font>' +" " + '<font style="font-size:14px">' + list_e[m].event_details + "  place: " + list_e[m].event_place + " at " + list_e[m].event_time + " " + "for " + x6+'</font>';

			   
			  x1 = list_e[m].event_type;
			  x2 = list_e[m].event_details;
	  	 	  x3 = list_e[m].event_time;
			  x4 = list_e[m].event_place;
			  var x5 = list_e[m].event_color;
			  
			  
			   iCount = list_key[m];
			  if( list_e[m].event_type=="Birthday")
			   newR1 = '<img src="birthday-cake.png" alt="birthday cake" width="15px" height="15px"> &nbsp  <font family="open-sans" color="#000000"; font-weight="bold" onclick="display('+iCount+')" style="cursor:pointer;background-color:'+x5+';border: 1px solid #473BEE;" onmouseover="bgChange('+1+','+iCount+')" onmouseout="bgChange1('+1+','+iCount+')" id="event1'+iCount+'"> &nbsp' + newR1 + '</font>';
			   
			   else if(list_e[m].event_type=="Anniversary")
			   newR1 = '<img src="rings.png" alt="rings" width="15px" height="15px"> &nbsp  <font family="open-sans" color="#000000" onclick="display('+iCount+')" style="cursor:pointer;background-color:'+x5+';border: 1px solid #473BEE;" onmouseover="bgChange('+2+','+iCount+')" onmouseout="bgChange1('+2+','+iCount+')" id="event2'+iCount+'">' + newR1 + '</font>';
			   else if(list_e[m].event_type=="Meeting")
			   newR1 = '<img src="meeting.png" alt="meeting" width="15px" height="15px"> &nbsp  <font family="open-sans" color="#000000" onclick="display('+iCount+')" style="cursor:pointer;background-color:'+x5+';border: 1px solid #473BEE;" onmouseover="bgChange('+3+','+iCount+')" onmouseout="bgChange1('+3+','+iCount+')" id="event3'+iCount+'">' + newR1 + '</font>';
			   else 
			   newR1 = '<font family="open-sans" color="#000000" onclick="display('+iCount+')" style="cursor:pointer;background-color:'+x5+';border: 1px solid #473BEE;" onmouseover="bgChange('+4+','+iCount+')" onmouseout="bgChange1('+4+','+iCount+')" id="event4'+iCount+'">' + newR1 + '</font>';
			  
			  
			  
			  
			    newC1 = newR1 + '<br>' +newC1;
                newC2 ='<img src="delete.png" alt="delete event" width="15px" height="15px" style="float: right;cursor: pointer;margin:2px;align:center;" id="rem_btn_'+iCount+'" onclick=removeItem('+iCount+');>' + '<br>' + newC2;
				newC3 ='<img src="edit.png" alt="edit form" width="15px" height="15px" style="float: right;cursor: pointer;margin:2px;align:center;" id="edit_btn_'+iCount+'" onclick=editItem('+iCount+');>' + '<br>' + newC3;                   
			    			   
						   iCount++;
				 }
		  
		   }   
		   
		    newC.innerHTML = '<p style = "text-align:left;">'+ newC1 +'</p>';
		    
		 
		  
        }	
	
		if(i==2){
		 
		  newC.innerHTML = newC2;
		  
		  newC2="";
		}
		
		
		
		if(i==3){
	 
		  newC.innerHTML = newC3;
		  newC3="";
		}
		

		
		if(i==4)
		{
		  newC.innerHTML = '<img src="add.png" alt="adding events" width="10px" height="10px" style="float:right; padding: 5px;cursor: pointer" onclick="add_events('+j+')">' ;
		
		}
       }
	   
    }
	
}

function bgChange(x,i1)
{
  var y="event"+x+i1;

  document.getElementById(y).style.backgroundColor = "#c2d7f9";
  document.getElementById(y).style.textDecoration="underline";
  document.getElementById(y).style.color="#473BEE";
  
}

function bgChange1(x,i2)
{
  var y="event"+x+i2;
 
  var key_1 = set1 + "w" + i2;
 
  var item = localStorage.getItem(key_1);
  var todoItem1 = JSON.parse(item);
  var c = todoItem1.event_color
 
  document.getElementById(y).style.backgroundColor = c;
   document.getElementById(y).style.textDecoration="none";
    document.getElementById(y).style.color="#000000";
}

function change_mon()
{
  var click = document.getElementById("drop");
  if(click.style.display==="none")
  click.style.display = "block";
  else
  click.style.display = "none";
}


//changing the month
function changeMonBefore(month)
{
  theMonth = theMonth-1; 
  if(theMonth<0)
  {
    theMonth = 12;
	theYear = theYear-1;
  }
  populateTable1(theMonth,theYear);
  populateTable2(theMonth,theYear);
}


function changeMonAfter(month)
{
  theMonth = theMonth + 1;
  if(theMonth>11)
  {
     theMonth = 0;
	theYear = theYear+1;
  }
  populateTable1(theMonth,theYear);
  populateTable2(theMonth,theYear);
}



//double clicking on a date
function double_dayClick(e)
{

	 k = e.target.innerText;
	
	populateTable2(theMonth,theYear);
	emptyField();
 	document.getElementById("Reminder_prompt_overlay").style.display="block";
	  
}

//adding events
function add_events(t){
   emptyField();
   document.getElementById("Reminder_prompt_overlay").style.display="block";
}


//editing Items
function editItem(iCounter2){
    var item = localStorage.getItem(set1+"w"+iCounter2);
	iSave=iCounter2;
	
    var todoItem = JSON.parse(item);
	document.getElementById("event_type1").value=todoItem.event_type;
	document.getElementById("event_details1").value=todoItem.event_details;
	
	if(todoItem.event_place==undefined)
	document.getElementById("event_place1").value="";
	else
	document.getElementById("event_place1").value=todoItem.event_place;
	
	document.getElementById("event_time1").value=todoItem.event_time;
	document.getElementById("event_color1").value=todoItem.event_color;
	document.getElementById("event_duration1").value=todoItem.event_duration;
	document.getElementById("edit_events_overlay").style.display="block";
}


//saving edited changes
function saveChange(){
     iCount=iCount-1;
     //console.log(iCount);
     localStorage.removeItem(set1+"w"+iSave);
     var event_type1 = document.getElementById("event_type1").value;
	 var event_details1 = document.getElementById("event_details1").value;
	 var event_time1 = document.getElementById("event_time1").value;	
	 var event_place1 = document.getElementById("event_place1").value;	
	 var event_color1 = document.getElementById("event_color1").value;	
	 var event_duration1 = document.getElementById("event_duration1").value;	
	 
	 var objectTest = {
	     event_type: event_type,
		 event_details: event_details,
		 event_time: event_time,
		 event_place: event_place,
		 event_color: event_color,
		 event_duration: event_duration
   };

   objectTest.event_type = event_type1;
   objectTest.event_details = event_details1;
   objectTest.event_time = event_time1;
   objectTest.event_place = event_place1;
   objectTest.event_color = event_color1;
   objectTest.event_duration = event_duration1;
   localStorage.setItem(set1 + "w" + iSave,JSON.stringify(objectTest));
   populateTable2(theMonth,theYear);
   document.getElementById("edit_events_overlay").style.display = "none";
   
}

//cancel editItem
function cancelChange(){
 document.getElementById("edit_events_overlay").style.display = "none";
}


//displaying event details
function display(iCounter1){
    var item = localStorage.getItem(set1+"w"+iCounter1);
    var todoItem = JSON.parse(item);
	document.getElementById("disp_type").innerHTML=todoItem.event_type;
	document.getElementById("disp_detail").innerHTML=todoItem.event_details;
	document.getElementById("disp_duration").innerHTML=todoItem.event_duration;
	if((todoItem.event_place==undefined)||(todoItem.event_place==""))
	{	
	  document.getElementById("disp_place_tag").style.display="none";
	  document.getElementById("disp_place").style.display="none";
	}
	else
	{
	  document.getElementById("disp_place_tag").style.display="block";
	  document.getElementById("disp_place").style.display="block";
	  document.getElementById("disp_place").innerHTML=todoItem.event_place;
	}
	document.getElementById("disp_time").innerHTML=todoItem.event_time;
	document.getElementById("display_overlay").style.display="block";
	
}


//closing the display form
function close_form(){
  document.getElementById("display_overlay").style.display="none";
}



function removeItem(iCounter){
	document.getElementById("Delete_prompt_overlay").style.display="block";
	document.getElementById("btn_yes").onclick=function(){
	 if(localStorage)
		{
		 //  console.log(set1+" set1");
		  // console.log(set1+"w"+iCounter);
		  //document.getElementById("Reminder_prompt_overlay").style.display="block";
		   localStorage.removeItem(set1+"w"+iCounter);
		   
		}
		document.getElementById("Delete_prompt_overlay").style.display="none";

		populateTable2(theMonth,theYear);
	};

	document.getElementById("btn_no").onclick=function(){
	  document.getElementById("Delete_prompt_overlay").style.display="none";
	};
}

// create dynamic list of year choices
function fillYears() {
    var today = new Date();
    var thisYear = today.getFullYear();
    var yearChooser = document.dateChooser.chooseYear;
    for (i = thisYear; i < thisYear + 15; i++) {
        yearChooser.options[yearChooser.options.length] = new Option(i, i);
    }
    setCurrMonth(today);
}


// set month choice to current month
function setCurrMonth(today) {
    document.dateChooser.chooseMonth.selectedIndex = today.getMonth();
}



	 set2 = set1;
	 var event_type = document.getElementById("event_type");
	 var event_details = document.getElementById("event_details");
	 var event_time = document.getElementById("event_time");
	 var event_place = document.getElementById("event_place");
	 var event_color = document.getElementById("event_color");
	 var event_duration = document.getElementById("event_duration");
	 var submit= document.getElementById("button");
	 var cancel = document.getElementById("button1");
	
	
	 
	  document.getElementById("button").onclick = function(){
	  var et=event_type.value;
	  var ed = event_details.value;
	  var etime = event_time.value;
	  var ep = event_place.value;
	  var ec = event_color.value;
	  var edu = event_duration.value;
	
	  if(!(et && ed && etime && ec && ed))
	  {
	     document.getElementById("outputArea").style.display="block";
	  }
	  else
	 {
	          document.getElementById("outputArea").style.display="none";
        	 createObject(et,ed,etime,ep,ec,edu);
	  }
	 };
	 
	document.getElementById("button1").onclick = function(){
	
	document.getElementById("Adding_events_overlay").style.display = "none";
	
	}
    
   function createObject(event_type, event_details, event_time,event_place,event_color,event_duration){
     var objectTest = {
	     event_type: event_type,
		 event_details: event_details,
		 event_time: event_time,
		 event_place: event_place,
		 event_color: event_color,
		 event_duration: event_duration
   };
 
   objectTest.event_type = event_type;
   objectTest.event_details = event_details;
   objectTest.event_time = event_time;
   objectTest.event_place = event_place;
   objectTest.event_color = event_color;
   objectTest.event_duration = event_duration;
   var key;
  
   
 
   if (localStorage) {
        for (var i = 0; i < localStorage.length; i++) {
            key = localStorage.key(i);
 	    
            if ((key.substring(0,9) == set1)||(key.substring(0,8)==set1)||(key.substring(0,10)==set1)) {
			   l++;
		
                var item = localStorage.getItem(key);
                var todoItem = JSON.parse(item);
                list_e.push(todoItem);
           }
        }
	}
	
   saveObject(objectTest);
  }
  
		
  function saveObject(objectTest){
   	var i=localStorage.length;
	localStorage.setItem(set1 + "w" + (l+1),JSON.stringify(objectTest));
	
	document.getElementById("Adding_events_overlay").style.display = "none";
	var n = events.includes(set1);
	if(n==false)
	events.push(set1);
	console.log("length is " + events.length);
	populateTable2(theMonth,theYear);
  }
</SCRIPT>
</HTML>